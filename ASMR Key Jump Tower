local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/WhoGodsyoure/Home/refs/heads/main/Neko.lua"))()
local ThemeManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/WhoGodsyoure/Home/refs/heads/main/ThemeManager.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/WhoGodsyoure/Home/refs/heads/main/SaveManager.lua"))()

local Window = Library:CreateWindow({
    Title = "ArchiveXNova",
    Footer = "ASMR Key Jump Tower | YouTube: ArchiveXNova",
    Icon = 85025739024001,
    NotifySide = "Right",
    ShowCustomCursor = true,
    Center = true,
    AutoShow = true,
})

local Tabs = {
    Main = Window:AddTab("Main"),
    ["UI Settings"] = Window:AddTab("Settings")
}

local Group = Tabs.Main:AddLeftGroupbox("Coin")

local RunService = game:GetService("RunService")
local Player = game:GetService("Players").LocalPlayer

local loopConn

local function getHRP()
    local char = Player.Character or Player.CharacterAdded:Wait()
    return char:WaitForChild("HumanoidRootPart")
end

local function touchAllCoins()
    local hrp = getHRP()

    local coinsFolder = workspace:FindFirstChild("Coins")
    if not coinsFolder then return end

    for _, model in ipairs(coinsFolder:GetChildren()) do
        if model:IsA("Model") then
            for _, part in ipairs(model:GetChildren()) do
                if part:IsA("BasePart") then
                    firetouchinterest(hrp, part, 0)
                    firetouchinterest(hrp, part, 1)
                end
            end
        end
    end
end

Group:AddDropdown("ModeDropdown", {
    Values = {
        "Once",
        "Loop",
        "Stop Loop"
    },
    Default = 1,
    Multi = false,
    Text = "Coin Touch Mode",
    Callback = function(Value)
        if loopConn then
            loopConn:Disconnect()
            loopConn = nil
        end

        if Value == "Once" then
            touchAllCoins()

        elseif Value == "Loop" then
            loopConn = RunService.Heartbeat:Connect(function()
                touchAllCoins()
            end)
        end
    end
})

local Group = Tabs.Main:AddLeftGroupbox("Infinite")

Group:AddButton({
    Text = "Air Jump",
    Func = function()
        local Event = game:GetService("ReplicatedStorage"):WaitForChild("AirJumpEvent")
        firesignal(Event.OnClientEvent, math.huge)
    end
})

local Group = Tabs.Main:AddLeftGroupbox("Win")

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local TARGET_POS = Vector3.new(758.783, 1138.529, 1160.898)

local looping = false
local loopConn
local antiAfkConn

local delays = {
    ["Normal"] = 0.5,
    ["Fast"] = 0.25,
    ["Super Fast"] = 0,

    ["Normal Loop"] = 0.5,
    ["Fast Loop"] = 0.2,
    ["Safe Loop"] = 0.8,

    ["Safe Mode (higher delay)"] = 1,
    ["Light Mode"] = 0.4,
    ["Normal Mode"] = 0.3,

    ["AFK Mode"] = 0
}

local function getHRP()
    local char = player.Character or player.CharacterAdded:Wait()
    return char:WaitForChild("HumanoidRootPart"), char
end

local function teleport(delayTime)
    local hrp, char = getHRP()
    hrp.CFrame = CFrame.new(TARGET_POS)

    if delayTime == 0 then
        RunService.Heartbeat:Wait()
    else
        task.wait(delayTime)
    end

    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.Health = 0
    end
end

local function startAntiAfk()
    if antiAfkConn then return end
    local VirtualUser = game:GetService("VirtualUser")
    antiAfkConn = player.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
end

local function stopAll()
    looping = false
    if loopConn then
        loopConn:Disconnect()
        loopConn = nil
    end
    if antiAfkConn then
        antiAfkConn:Disconnect()
        antiAfkConn = nil
    end
end

local function startLoop(delayTime, duration)
    stopAll()
    looping = true

    local startTime = os.clock()
    loopConn = RunService.Heartbeat:Connect(function()
        if not looping then return end
        teleport(delayTime)

        if duration and os.clock() - startTime >= duration then
            stopAll()
        end
    end)
end

Group:AddDropdown("ModeDropdown", {
    Values = {
        "One-Time: Normal",
        "One-Time: Fast",
        "One-Time: Super Fast",

        "Loop: Normal Loop",
        "Loop: Fast Loop",
        "Loop: Safe Loop",
        "Stop Loop",

        "Time Mode: Run for 30 seconds",
        "Time Mode: Run for 1 minute",

        "Stability: Safe Mode (higher delay)",

        "Performance: Light Mode",
        "Performance: Normal Mode",

        "AFK / Farm: AFK Mode",

        "Sistem: Stop All"
    },
    Default = 1,
    Multi = false,
    Text = "Mode",
    Callback = function(Value)
        stopAll()

        if Value == "Stop Loop" or Value == "Sistem: Stop All" then
            return
        end

        if Value:find("One%-Time") then
            local mode = Value:match("One%-Time:%s(.+)")
            teleport(delays[mode] or 0.4)
            return
        end

        if Value:find("^Loop:") then
            local mode = Value:match("Loop:%s(.+)")
            startLoop(delays[mode] or 0.4)
            return
        end

        if Value == "Time Mode: Run for 30 seconds" then
            startLoop(0.4, 30)
            return
        end

        if Value == "Time Mode: Run for 1 minute" then
            startLoop(0.4, 60)
            return
        end

        if Value:find("^AFK") then
            startAntiAfk()
            startLoop(delays["AFK Mode"])
            return
        end

        if Value:find("Stability:") or Value:find("Performance:") then
            local mode = Value:match(":%s(.+)")
            startLoop(delays[mode] or 0.5)
        end
    end
})

local UIGroup = Tabs["UI Settings"]

ThemeManager:SetLibrary(Library)
SaveManager:SetLibrary(Library)

SaveManager:IgnoreThemeSettings()
SaveManager:SetFolder("ArchiveXNova")
SaveManager:BuildConfigSection(Tabs["UI Settings"])
ThemeManager:ApplyToTab(Tabs["UI Settings"])
